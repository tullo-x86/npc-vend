<!DOCTYPE html>
<html ng-app="indexApp">
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/styles/base.css' />
    <script type='text/javascript' src='/script/lib/angular.min.js'></script>
    <script type='text/javascript' src='/script/controllers/index-controller.js'></script>
  </head>
  <body ng-controller="MainController">

    <div class="debug">
      <button type="button" ng-click="debugStateReady()">Ready</button>
      <button type="button" ng-click="debugStateSelected()">Selected</button>
      <button type="button" ng-click="debugStateConfirmRich()">Confirm (rich user)</button>
      <button type="button" ng-click="debugStateConfirmPoor()">Confirm (poor user)</button>
    </div>

    <div class="main">
      <!-- WELCOME STATE: Waiting for a selection -->
      <div ng-if="state == 'ready'">
        <fieldset>
          <legend>HSBNE vending machine</legend>
          <p>Please make a selection to begin.</p>
        </fieldset>
      </div>

      <!-- SELECTED STATE: Waiting for user to log in -->
      <div ng-if="state == 'selected'">
        <fieldset>
          <legend>HSBNE vending machine</legend>
          <div class="content">
            <h1>{{item.name}}</h1>
            <h3>Price: {{formatCurrency(item.price)}}</h3>
          </div>
        </fieldset>
      </div>

      <!-- CONFIRM STATE: Waiting for authenticated user to confirm purchase -->
      <div ng-if="state == 'confirm'">
        <fieldset>
          <legend>{{user.name}}</legend>
          <div class="content">
            <h1>{{item.name}}</h1>
            <h3>Price: {{formatCurrency(item.price)}}</h3>
            <h3>Your balance: {{formatCurrency(user.balance)}}</h3>
            <button type="button" ng-click="confirmPurchase()" ng-disabled="!canAffordItem()" class="fullwidth confirm">Purchase</button>
            <button type="button" ng-click="cancelPurchase()" class="fullwidth cancel">Cancel</button>
          </div>
        </fieldset>
      </div>
    </div>
  </body>
</html>